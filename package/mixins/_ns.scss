@use '../vars/config';
@use 'fn';

@mixin b($block) {
  .#{fn.join-ns($block)} {
    @content;
  }
}

@mixin e($element) {
  @at-root #{& + config.$element-separator + $element} {
    @content;
  }
}

@mixin m($modifier) {
  @at-root #{& + config.$modifier-separator + $modifier} {
    @content;
  }
}

@mixin when($state) {
  @at-root &.#{config.$state-prefix + $state} {
    @content;
  }
}

@mixin dark($block) {
  html.dark {
    @include b($block) {
      @content;
    }
  }
}

@mixin bem($block, $element: null, $modifier: null) {
  .#{genSelector($block, $element, $modifier)} {
    @content;
  }
}

@mixin bem-root($block, $element: null, $modifier: null) {
  @at-root &.#{genSelector($block, $element, $modifier)} {
    @content;
  }
}

@mixin bem-child($block, $element: null, $modifier: null) {
  @at-root & > #{genSelector($block, $element, $modifier)} {
    @content;
  }
}

@function genSelector($block, $element, $modifier) {
  $el: if($element, config.$element-separator + $element, '');
  $mod: if($modifier, config.$modifier-separator + $modifier, '');

  @return fn.join-ns($block) + $el + $mod;
}
